{
"version":3,
"file":"module$node_modules$focus_lock$dist$cjs$focusMerge.js",
"lineCount":9,
"mappings":"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",
"sources":["node_modules/focus-lock/dist/cjs/focusMerge.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$focus_lock$dist$cjs$focusMerge\"] = function(global,require,module,exports) {\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getFocusabledIn = exports.newFocus = undefined;\n\nvar _DOMutils = require('./utils/DOMutils');\n\nvar _firstFocus = require('./utils/firstFocus');\n\nvar _firstFocus2 = _interopRequireDefault(_firstFocus);\n\nvar _allAffected = require('./utils/all-affected');\n\nvar _allAffected2 = _interopRequireDefault(_allAffected);\n\nvar _array = require('./utils/array');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar findAutoFocused = function findAutoFocused(autoFocusables) {\n  return function (node) {\n    return !!node.autofocus || node.dataset && !!node.dataset.autofocus || autoFocusables.indexOf(node) >= 0;\n  };\n};\n\nvar isGuard = function isGuard(node) {\n  return node.dataset && node.dataset.focusGuard;\n};\nvar notAGuard = function notAGuard(node) {\n  return !isGuard(node);\n};\n\nvar newFocus = exports.newFocus = function newFocus(innerNodes, outerNodes, activeElement, lastNode, autoFocused) {\n  var cnt = innerNodes.length;\n  var firstFocus = innerNodes[0];\n  var lastFocus = innerNodes[cnt - 1];\n\n  // focus is inside\n  if (innerNodes.indexOf(activeElement) >= 0) {\n    return undefined;\n  }\n\n  var activeIndex = outerNodes.indexOf(activeElement);\n  var lastIndex = outerNodes.indexOf(lastNode || activeIndex);\n  var lastNodeInside = innerNodes.indexOf(lastNode);\n  var indexDiff = activeIndex - lastIndex;\n  var firstNodeIndex = outerNodes.indexOf(firstFocus);\n  var lastNodeIndex = outerNodes.indexOf(lastFocus);\n\n  // new focus\n  if (activeIndex === -1 || lastNodeInside === -1) {\n    return innerNodes.indexOf(autoFocused.length ? (0, _firstFocus2.default)(autoFocused) : (0, _firstFocus2.default)(innerNodes));\n  }\n  // old focus\n  if (!indexDiff && lastNodeInside >= 0) {\n    return lastNodeInside;\n  }\n  // first element\n  if (activeIndex <= firstNodeIndex && isGuard(activeElement) && Math.abs(indexDiff) > 1) {\n    return 0;\n  }\n  // jump out\n  if (indexDiff && Math.abs(indexDiff) > 1) {\n    return lastNodeInside;\n  }\n  // focus above lock\n  if (activeIndex <= firstNodeIndex) {\n    return cnt - 1;\n  }\n  // focus below lock\n  if (activeIndex > lastNodeIndex) {\n    return 0;\n  }\n  // index is inside tab order, but outside Lock\n  if (indexDiff) {\n    if (Math.abs(indexDiff) > 1) {\n      return lastNodeInside;\n    }\n    return (cnt + lastNodeInside + indexDiff) % cnt;\n  }\n  // do nothing\n  return undefined;\n};\n\nvar getTopCommonParent = function getTopCommonParent(baseActiveElement, leftEntry, rightEntries) {\n  var activeElements = (0, _array.asArray)(baseActiveElement);\n  var leftEntries = (0, _array.asArray)(leftEntry);\n  var activeElement = activeElements[0];\n  var topCommon = null;\n  leftEntries.filter(Boolean).forEach(function (entry) {\n    topCommon = (0, _DOMutils.getCommonParent)(topCommon || entry, entry) || topCommon;\n    rightEntries.filter(Boolean).forEach(function (subEntry) {\n      var common = (0, _DOMutils.getCommonParent)(activeElement, subEntry);\n      if (common) {\n        if (!topCommon || common.contains(topCommon)) {\n          topCommon = common;\n        } else {\n          topCommon = (0, _DOMutils.getCommonParent)(common, topCommon);\n        }\n      }\n    });\n  });\n  return topCommon;\n};\n\nvar allParentAutofocusables = function allParentAutofocusables(entries) {\n  return entries.reduce(function (acc, node) {\n    return acc.concat((0, _DOMutils.parentAutofocusables)(node));\n  }, []);\n};\n\nvar reorderNodes = function reorderNodes(srcNodes, dstNodes) {\n  var remap = new Map();\n  // no Set(dstNodes) for IE11 :(\n  dstNodes.forEach(function (entity) {\n    return remap.set(entity.node, entity);\n  });\n  // remap to dstNodes\n  return srcNodes.map(function (node) {\n    return remap.get(node);\n  }).filter(Boolean);\n};\n\nvar getFocusabledIn = exports.getFocusabledIn = function getFocusabledIn(topNode) {\n  var entries = (0, _allAffected2.default)(topNode).filter(notAGuard);\n  var commonParent = getTopCommonParent(topNode, topNode, entries);\n  var outerNodes = (0, _DOMutils.getTabbableNodes)([commonParent], true);\n  var innerElements = (0, _DOMutils.getTabbableNodes)(entries).filter(function (_ref) {\n    var node = _ref.node;\n    return notAGuard(node);\n  }).map(function (_ref2) {\n    var node = _ref2.node;\n    return node;\n  });\n\n  return outerNodes.map(function (_ref3) {\n    var node = _ref3.node,\n        index = _ref3.index;\n    return {\n      node: node,\n      index: index,\n      lockItem: innerElements.indexOf(node) >= 0,\n      guard: isGuard(node)\n    };\n  });\n};\n\nvar getFocusMerge = function getFocusMerge(topNode, lastNode) {\n  var activeElement = document && document.activeElement;\n  var entries = (0, _allAffected2.default)(topNode).filter(notAGuard);\n\n  var commonParent = getTopCommonParent(activeElement || topNode, topNode, entries);\n\n  var innerElements = (0, _DOMutils.getTabbableNodes)(entries).filter(function (_ref4) {\n    var node = _ref4.node;\n    return notAGuard(node);\n  });\n\n  if (!innerElements[0]) {\n    innerElements = (0, _DOMutils.getAllTabbableNodes)(entries).filter(function (_ref5) {\n      var node = _ref5.node;\n      return notAGuard(node);\n    });\n    if (!innerElements[0]) {\n      return undefined;\n    }\n  }\n\n  var outerNodes = (0, _DOMutils.getTabbableNodes)([commonParent]).map(function (_ref6) {\n    var node = _ref6.node;\n    return node;\n  });\n  var orderedInnerElements = reorderNodes(outerNodes, innerElements);\n  var innerNodes = orderedInnerElements.map(function (_ref7) {\n    var node = _ref7.node;\n    return node;\n  });\n\n  var newId = newFocus(innerNodes, outerNodes, activeElement, lastNode, innerNodes.filter(findAutoFocused(allParentAutofocusables(entries))));\n\n  if (newId === undefined) {\n    return newId;\n  }\n  return orderedInnerElements[newId];\n};\n\nexports.default = getFocusMerge;\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","getFocusabledIn","newFocus","undefined","_DOMutils","_firstFocus2","_firstFocus","__esModule","default","_allAffected2","_allAffected","_array","findAutoFocused","autoFocusables","node","autofocus","dataset","indexOf","isGuard","focusGuard","notAGuard","exports.newFocus","innerNodes","outerNodes","activeElement","lastNode","autoFocused","cnt","length","firstFocus","lastFocus","activeIndex","lastIndex","lastNodeInside","indexDiff","firstNodeIndex","lastNodeIndex","Math","abs","getTopCommonParent","baseActiveElement","leftEntry","rightEntries","activeElements","asArray","leftEntries","topCommon","filter","Boolean","forEach","entry","getCommonParent","subEntry","common","contains","allParentAutofocusables","entries","reduce","acc","concat","parentAutofocusables","reorderNodes","srcNodes","dstNodes","remap","Map","entity","set","map","get","exports.getFocusabledIn","topNode","commonParent","getTabbableNodes","innerElements","_ref","_ref2","_ref3","index","lockItem","guard","getFocusMerge","document","_ref4","getAllTabbableNodes","_ref5","_ref6","orderedInnerElements","_ref7","newId"]
}
